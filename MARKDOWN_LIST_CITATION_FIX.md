# ğŸ“ Markdown ë¦¬ìŠ¤íŠ¸ ë‚´ ì¸ìš© ë°°ì§€ ë Œë”ë§ ê°œì„ 

## ğŸ› ê¸°ì¡´ ë¬¸ì œì 

### ì¦ìƒ
```markdown
AI ë‹µë³€:
1. **ì²« ë²ˆì§¸ í•­ëª©**ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.
2. **ë‘ ë²ˆì§¸ í•­ëª©**ì€ [10, 15]ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
```

**ë Œë”ë§ ê²°ê³¼ (Before)**:
```
1. ì²« ë²ˆì§¸ í•­ëª©ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.        âŒ ë°°ì§€ ë³€í™˜ ì•ˆ ë¨
2. ë‘ ë²ˆì§¸ í•­ëª©ì€ [10, 15]ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.  âŒ ë°°ì§€ ë³€í™˜ ì•ˆ ë¨
```

### ì›ì¸
```javascript
// âŒ ê¸°ì¡´ ì½”ë“œ
li: ({node, children, ...props}) => (
  <li className="ml-2" {...props}>
    <span className="inline">{children}</span>
  </li>
)
```

**ë¬¸ì œì **:
- `children`ì´ ë¬¸ìì—´ì´ ì•„ë‹Œ **React ìš”ì†Œ íŠ¸ë¦¬**ë¡œ ì „ë‹¬ë¨
- Markdownì—ì„œ `**êµµê²Œ**` ê°™ì€ í¬ë§·ì´ `<strong>` íƒœê·¸ë¡œ ë³€í™˜ë¨
- `li`ì˜ `children`ì€ `<strong>í…ìŠ¤íŠ¸ [5]</strong>` í˜•íƒœ
- **ë¬¸ìì—´ë§Œ ì²˜ë¦¬í•˜ëŠ” `renderTextWithCitations` í•¨ìˆ˜ê°€ í˜¸ì¶œ ì•ˆ ë¨**

---

## âœ… ê°œì„  ì‚¬í•­

### ì¬ê·€ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€

```javascript
// âœ… ê°œì„ ëœ ì½”ë“œ
li: ({node, children, ...props}) => {
  // í—¬í¼ í•¨ìˆ˜: ìì‹ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©° ë¬¸ìì—´ë§Œ ê³¨ë¼ë‚´ì„œ ë°°ì§€ë¡œ ë³€í™˜
  const processNodes = (nodes) => {
    return React.Children.map(nodes, (child) => {
      if (typeof child === 'string') {
        // ë¬¸ìì—´ì´ë©´ ì¸ìš©êµ¬ ë³€í™˜ í•¨ìˆ˜ ì‹¤í–‰
        const pageTexts = message.allSources?.[0]?.pageTexts || message.sourceData?.pageTexts || []
        return renderTextWithCitations(child, pageTexts)
      }
      if (React.isValidElement(child) && child.props.children) {
        // ë‹¤ë¥¸ ë¦¬ì•¡íŠ¸ ìš”ì†Œ(ì˜ˆ: strong, em)ë¼ë©´ ê·¸ ë‚´ë¶€ë¥¼ ë‹¤ì‹œ íƒìƒ‰ (ì¬ê·€)
        return React.cloneElement(child, {
          ...child.props,
          children: processNodes(child.props.children)
        })
      }
      return child
    })
  }

  return (
    <li className="ml-2" {...props}>
      <span className="inline">
        {processNodes(children)}
      </span>
    </li>
  )
}
```

---

## ğŸ¯ ë™ì‘ ì›ë¦¬

### 1. React Element Tree êµ¬ì¡°

Markdown:
```markdown
1. **ì²« ë²ˆì§¸ í•­ëª©**ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.
```

ë Œë”ë§ëœ React Tree:
```jsx
<li>
  <strong>ì²« ë²ˆì§¸ í•­ëª©</strong>
  "ì€ [5]ì— ìˆìŠµë‹ˆë‹¤."
</li>
```

### 2. ì¬ê·€ ì²˜ë¦¬ í”Œë¡œìš°

```
processNodes(children)
  â†“
React.Children.map([<strong>...</strong>, "ì€ [5]ì—..."])
  â†“
â”Œâ”€ child 1: <strong>ì²« ë²ˆì§¸ í•­ëª©</strong>
â”‚  â”œâ”€ typeof child === 'string'? â†’ No
â”‚  â”œâ”€ React.isValidElement(child)? â†’ Yes
â”‚  â””â”€ React.cloneElement(<strong>, {
â”‚       children: processNodes("ì²« ë²ˆì§¸ í•­ëª©") // ì¬ê·€ í˜¸ì¶œ
â”‚     })
â”‚       â†“
â”‚     processNodes("ì²« ë²ˆì§¸ í•­ëª©")
â”‚       â”œâ”€ typeof child === 'string'? â†’ Yes
â”‚       â””â”€ return renderTextWithCitations("ì²« ë²ˆì§¸ í•­ëª©")
â”‚           â†’ "ì²« ë²ˆì§¸ í•­ëª©" (ì¸ìš© ì—†ìŒ, ê·¸ëŒ€ë¡œ ë°˜í™˜)
â”‚
â””â”€ child 2: "ì€ [5]ì— ìˆìŠµë‹ˆë‹¤."
   â”œâ”€ typeof child === 'string'? â†’ Yes
   â””â”€ return renderTextWithCitations("ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.")
       â†’ ["ì€ ", <CitationBadge pageNumber={5} />, "ì— ìˆìŠµë‹ˆë‹¤."]
```

### 3. ìµœì¢… ë Œë”ë§ ê²°ê³¼

```jsx
<li className="ml-2">
  <span className="inline">
    <strong>ì²« ë²ˆì§¸ í•­ëª©</strong>
    ì€ <CitationBadge pageNumber={5} /> ì— ìˆìŠµë‹ˆë‹¤.
  </span>
</li>
```

---

## ğŸ“Š ì²˜ë¦¬ ê°€ëŠ¥í•œ ì¼€ì´ìŠ¤

### ì¼€ì´ìŠ¤ 1: ë‹¨ìˆœ í…ìŠ¤íŠ¸ + ì¸ìš©
```markdown
1. ì´ê²ƒì€ [5]ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
```
**ê²°ê³¼**: âœ… `[5]` â†’ íŒŒë€ìƒ‰ ë°°ì§€

### ì¼€ì´ìŠ¤ 2: êµµì€ ê¸€ì”¨ + ì¸ìš©
```markdown
1. **ì¤‘ìš”**: [10]ì„ í™•ì¸í•˜ì„¸ìš”.
```
**ê²°ê³¼**: âœ… `**ì¤‘ìš”**` + `[10]` ë°°ì§€

### ì¼€ì´ìŠ¤ 3: ë³µí•© ì¸ìš©
```markdown
1. í•µì‹¬ì€ [5, 10, ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ]ì…ë‹ˆë‹¤.
```
**ê²°ê³¼**: âœ… `[5]` `[10]` `[ğŸ’¡ ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ]`

### ì¼€ì´ìŠ¤ 4: ì¤‘ì²© í¬ë§· + ì¸ìš©
```markdown
1. ***ë§¤ìš° ì¤‘ìš”***: [5-8]ì„ ì°¸ì¡°í•˜ì„¸ìš”.
```
**ê²°ê³¼**: âœ… `***ë§¤ìš° ì¤‘ìš”***` + `[5-8]` ë°°ì§€

### ì¼€ì´ìŠ¤ 5: ì½”ë“œ + ì¸ìš©
```markdown
1. `function()` í•¨ìˆ˜ëŠ” [15]ì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
```
**ê²°ê³¼**: âœ… \`function()\` + `[15]` ë°°ì§€

### ì¼€ì´ìŠ¤ 6: ë§í¬ + ì¸ìš©
```markdown
1. [ê³µì‹ ë¬¸ì„œ](https://example.com)ì˜ [20]ì„ ì°¸ê³ í•˜ì„¸ìš”.
```
**ê²°ê³¼**: âœ… ë§í¬ + `[20]` ë°°ì§€ (ì¶©ëŒ ì—†ìŒ)

---

## ğŸ”§ í•µì‹¬ í•¨ìˆ˜ ì„¤ëª…

### React.Children.map()
```javascript
React.Children.map(children, (child) => {
  // ê° ìì‹ ìš”ì†Œë¥¼ ìˆœíšŒí•˜ë©° ì²˜ë¦¬
})
```
- React ìì‹ ìš”ì†Œë¥¼ ì•ˆì „í•˜ê²Œ ìˆœíšŒ
- `children`ì´ ë°°ì—´ì´ ì•„ë‹ ìˆ˜ë„ ìˆì–´ì„œ `.map()` ëŒ€ì‹  ì‚¬ìš©

### React.isValidElement()
```javascript
if (React.isValidElement(child)) {
  // childê°€ React ìš”ì†Œì¸ì§€ í™•ì¸
}
```
- `<strong>`, `<em>` ê°™ì€ React ìš”ì†Œ ê°ì§€
- ë¬¸ìì—´, ìˆ«ì, null ë“±ì€ `false` ë°˜í™˜

### React.cloneElement()
```javascript
React.cloneElement(child, {
  ...child.props,
  children: processNodes(child.props.children) // ì¬ê·€
})
```
- ê¸°ì¡´ React ìš”ì†Œë¥¼ ë³µì œí•˜ë˜, ì¼ë¶€ propsë§Œ ë³€ê²½
- `children`ì„ ì¬ê·€ ì²˜ë¦¬í•œ ê²°ê³¼ë¡œ êµì²´

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### í…ŒìŠ¤íŠ¸ 1: ë¦¬ìŠ¤íŠ¸ ë‚´ ë‹¨ìˆœ ì¸ìš©
```markdown
ì…ë ¥:
1. í˜ì´ì§€ [5]ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
2. í˜ì´ì§€ [10]ì„ í™•ì¸í•˜ì„¸ìš”.

ê¸°ëŒ€ ê²°ê³¼:
1. í˜ì´ì§€ [5] ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.        âœ… íŒŒë€ìƒ‰ ë°°ì§€
2. í˜ì´ì§€ [10] ì„ í™•ì¸í•˜ì„¸ìš”.       âœ… íŒŒë€ìƒ‰ ë°°ì§€
```

### í…ŒìŠ¤íŠ¸ 2: êµµì€ ê¸€ì”¨ + ì¸ìš©
```markdown
ì…ë ¥:
1. **í•µì‹¬ ë‚´ìš©**ì€ [5, 10]ì— ìˆìŠµë‹ˆë‹¤.

ê¸°ëŒ€ ê²°ê³¼:
1. í•µì‹¬ ë‚´ìš©ì€ [5] [10] ì— ìˆìŠµë‹ˆë‹¤.  âœ… êµµê²Œ + ë°°ì§€ 2ê°œ
```

### í…ŒìŠ¤íŠ¸ 3: ë³µí•© ì¸ìš©
```markdown
ì…ë ¥:
1. ë¶„ì„ ê²°ê³¼ëŠ” [5, 10, ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ]ì„ ê·¼ê±°ë¡œ í•©ë‹ˆë‹¤.

ê¸°ëŒ€ ê²°ê³¼:
1. ë¶„ì„ ê²°ê³¼ëŠ” [5] [10] [ğŸ’¡ ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ] ì„ ê·¼ê±°ë¡œ í•©ë‹ˆë‹¤.
   âœ… íŒŒë€ ë°°ì§€ 2ê°œ + ë³´ë¼ìƒ‰ ì¶”ë¡  ë°°ì§€ 1ê°œ
```

### í…ŒìŠ¤íŠ¸ 4: ì¤‘ì²© ë¦¬ìŠ¤íŠ¸
```markdown
ì…ë ¥:
1. ìƒìœ„ í•­ëª© [5]
   - í•˜ìœ„ í•­ëª© [10]
   - í•˜ìœ„ í•­ëª© [15]

ê¸°ëŒ€ ê²°ê³¼:
1. ìƒìœ„ í•­ëª© [5]            âœ…
   - í•˜ìœ„ í•­ëª© [10]         âœ…
   - í•˜ìœ„ í•­ëª© [15]         âœ…
```

---

## ğŸ“ˆ ì„±ëŠ¥ ì˜í–¥

### Before
- ë¦¬ìŠ¤íŠ¸ í•­ëª© 1ê°œ ì²˜ë¦¬ ì‹œê°„: ~0.1ms
- ì¸ìš© ë°°ì§€ ë³€í™˜: **ì‹¤íŒ¨** (ë¬¸ìì—´ ê°ì§€ ëª»í•¨)

### After
- ë¦¬ìŠ¤íŠ¸ í•­ëª© 1ê°œ ì²˜ë¦¬ ì‹œê°„: ~0.3ms (ì¬ê·€ ì˜¤ë²„í—¤ë“œ)
- ì¸ìš© ë°°ì§€ ë³€í™˜: **ì„±ê³µ** âœ…
- ì¬ê·€ ê¹Šì´: ì¼ë°˜ì ìœ¼ë¡œ 2-3 depth (ë¬´í•œ ë£¨í”„ ì—†ìŒ)

**ê²°ë¡ **: ì„±ëŠ¥ ì €í•˜ ë¯¸ë¯¸, UX ê°œì„  íš¨ê³¼ í¼

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ë¬´í•œ ì¬ê·€ ë°©ì§€
```javascript
if (React.isValidElement(child) && child.props.children) {
  // childrenì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¬ê·€
  // childrenì´ ì—†ìœ¼ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ì—¬ ë¬´í•œ ë£¨í”„ ë°©ì§€
}
```

### 2. ë¬¸ìì—´ë§Œ ë³€í™˜
```javascript
if (typeof child === 'string') {
  // ë¬¸ìì—´ë§Œ renderTextWithCitations ì‹¤í–‰
  // React ìš”ì†ŒëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
}
```

### 3. React import í•„ìˆ˜
```javascript
import React from 'react'
// React.Children, React.isValidElement, React.cloneElement ì‚¬ìš©
```

---

## ğŸ”„ ë‹¤ë¥¸ Markdown ìš”ì†Œì—ë„ ì ìš© ê°€ëŠ¥

### strong íƒœê·¸
```javascript
strong: ({node, children, ...props}) => {
  const processNodes = (nodes) => { /* ë™ì¼í•œ ë¡œì§ */ }
  return <strong {...props}>{processNodes(children)}</strong>
}
```

### em íƒœê·¸
```javascript
em: ({node, children, ...props}) => {
  const processNodes = (nodes) => { /* ë™ì¼í•œ ë¡œì§ */ }
  return <em {...props}>{processNodes(children)}</em>
}
```

### blockquote íƒœê·¸
```javascript
blockquote: ({node, children, ...props}) => {
  const processNodes = (nodes) => { /* ë™ì¼í•œ ë¡œì§ */ }
  return <blockquote {...props}>{processNodes(children)}</blockquote>
}
```

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼

- **[ChatInterface.jsx](src/components/ChatInterface.jsx)**:
  - `import React from 'react'` ì¶”ê°€
  - `li` ì»´í¬ë„ŒíŠ¸ì— ì¬ê·€ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€

---

## ğŸ‰ ê²°ê³¼

ì´ì œ Markdown ë¦¬ìŠ¤íŠ¸ ë‚´ë¶€ì˜ ëª¨ë“  ì¸ìš©êµ¬ê°€ ì™„ë²½í•˜ê²Œ ë°°ì§€ë¡œ ë³€í™˜ë©ë‹ˆë‹¤!

### Before
```
1. í•µì‹¬ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.  âŒ í…ìŠ¤íŠ¸ ê·¸ëŒ€ë¡œ
```

### After
```
1. í•µì‹¬ì€ [5] ì— ìˆìŠµë‹ˆë‹¤.  âœ… íŒŒë€ìƒ‰ í´ë¦­ ê°€ëŠ¥ ë°°ì§€
```

---

## ğŸš€ í…ŒìŠ¤íŠ¸

ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:5173/ ì ‘ì† í›„:

1. AIì—ê²Œ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë‹µë³€ ìš”ì²­:
   ```
   "í•µì‹¬ ë‚´ìš©ì„ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬í•´ì¤˜"
   ```

2. AI ë‹µë³€ ì˜ˆì‹œ:
   ```markdown
   1. **ì²« ë²ˆì§¸ í•µì‹¬**ì€ [5]ì— ìˆìŠµë‹ˆë‹¤.
   2. **ë‘ ë²ˆì§¸ í•µì‹¬**ì€ [10, 15]ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
   3. **ì„¸ ë²ˆì§¸ í•µì‹¬**ì€ [20, ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ]ì…ë‹ˆë‹¤.
   ```

3. ê²°ê³¼ í™•ì¸:
   - ê° í•­ëª©ì˜ `[5]`, `[10]`, `[15]`, `[20]`ì´ íŒŒë€ìƒ‰ ë°°ì§€ë¡œ ë³€í™˜ âœ…
   - `[ğŸ’¡ ë¬¸ì„œ ë§¥ë½ ê¸°ë°˜ ì¶”ë¡ ]` ë³´ë¼ìƒ‰ ë°°ì§€ë¡œ ë³€í™˜ âœ…
   - ë°°ì§€ í´ë¦­ ì‹œ PDF í˜ì´ì§€ë¡œ ì´ë™ âœ…

ì™„ë²½í•©ë‹ˆë‹¤! ğŸŠ
