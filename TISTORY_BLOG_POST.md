# NotebookLM 스타일 문서 분석 도구 개발기

안녕하세요! 오늘은 **NotebookLM 스타일의 문서 기반 AI 분석 도구**를 개발한 과정을 공유하려고 합니다. 엄격한 RAG(Retrieval-Augmented Generation) 시스템을 적용하여 문서의 내용만을 기반으로 답변하는 대시보드를 만드는 여정을 함께 살펴보겠습니다.

## 프로젝트를 시작하게 된 계기

ChatGPT 같은 일반적인 AI 챗봇들은 광범위한 지식을 바탕으로 답변을 생성하지만, 때로는 문서에 없는 내용을 만들어내는 할루시네이션 문제가 있습니다. 특히 중요한 문서를 분석할 때는 **정확한 출처가 명확한 답변**이 필요합니다.

NotebookLM을 참고하여, 업로드한 문서의 내용만을 기반으로 답변하고 모든 답변에 명확한 출처를 표시하는 도구를 만들어보기로 했습니다.

## 프로젝트 개요

### 목표

- NotebookLM과 유사한 문서 기반 AI 분석 도구 개발
- **엄격한 RAG 시스템**: 업로드한 문서의 내용만 사용하여 답변 생성
- 할루시네이션 방지: 문서에 없는 내용은 절대 답변하지 않음
- 명확한 출처 표시: 모든 답변에 참조 문서와 페이지 번호 표시

### 사용 기술

- **프론트엔드**: React 18, Vite, Tailwind CSS
- **PDF 처리**: PDF.js
- **AI 모델**: OpenAI GPT-4o/GPT-4o-mini, Google Gemini 3 Flash
- **배포**: Vercel

## 개발 과정

### 1. 프로젝트 초기 설정

Vite를 사용하여 React 프로젝트를 생성하고 필요한 패키지들을 설치했습니다.

```bash
npm create vite@latest notebooklm-dashboard -- --template react
cd notebooklm-dashboard
npm install
```

주요 패키지로는 `pdfjs-dist`(PDF 처리), `react-markdown`(마크다운 렌더링), `@google/generative-ai`(Gemini API) 등을 설치했습니다.

환경 변수는 `.env` 파일로 관리하여 API 키를 안전하게 보관했습니다.

### 2. UI 레이아웃 구성

NotebookLM의 특징적인 3단 레이아웃을 구현했습니다.

**좌측: 소스 패널**
- 파일 업로드 기능
- 체크박스 기반 다중 선택
- 전체 선택/해제 기능

**중앙: 채팅 인터페이스**
- 3개 AI 모델 선택 (빠름 / 심층 / Gemini)
- ReactMarkdown 렌더링
- 인용 배지 시스템
- 자동 문서 분석 및 추천 질문

**우측: 스튜디오 패널**
- PDF 뷰어 모드
- 자연어 분석 모드 (편집 가능한 문서 요약)
- JSON 데이터 모드
- AI 지침 설정 패널

### 3. 엄격한 RAG 시스템 구축

가장 중요한 부분은 **엄격한 RAG 시스템**을 구현하는 것이었습니다. 핵심은 업로드한 문서의 내용만을 사용하여 답변을 생성하는 것입니다.

PDF.js를 사용하여 PDF 파일의 실제 텍스트를 클라이언트에서 추출하고, 각 페이지별로 텍스트를 분리하여 저장했습니다. AI에게 질문할 때는 선택된 파일들의 내용만을 컨텍스트로 제공하고, 문서에 없는 내용에 대한 질문은 "문서에 없는 내용"이라고 명확히 답변하도록 구현했습니다.

**핵심 원칙:**
1. 선택된 파일에만 기반한 답변: 체크박스로 선택한 문서만 사용
2. 할루시네이션 방지: 문서에 없는 내용은 절대 답변하지 않음
3. 명확한 출처 표시: 모든 답변에 `[페이지 번호]` 형태로 출처 표시

### 4. PDF 처리 시스템

PDF.js를 활용하여 PDF 파일을 처리했습니다. 모든 페이지를 고품질 이미지로 변환하여 표시하고, 2배 스케일 렌더링으로 선명한 텍스트를 제공했습니다. 페이지별 텍스트를 추출하여 인덱싱하고, 인용 배지 클릭 시 해당 페이지로 자동 이동하는 기능도 구현했습니다.

### 5. 인용 배지 시스템

NotebookLM의 특징적인 인용 배지 시스템을 구현했습니다. AI가 답변에 `[5]` 같은 형태로 페이지 번호를 포함하면, 이를 클릭 가능한 배지로 변환합니다.

**지원하는 패턴:**
- 단일 페이지: `[5]` → 5번 페이지
- 범위: `[5-8]` → 5~8번 페이지
- 다중: `[5, 10, 15]` → 5, 10, 15번 페이지
- 자연어 패턴: "페이지 15", "15-18" 같은 대괄호 없는 패턴도 자동 감지

처음에는 `[5]` 형태만 지원했지만, AI가 자연스럽게 "페이지 15"라고 표현하는 경우가 많아서 자연어 패턴도 자동 감지하도록 개선했습니다. 또한 `[문서 맥락 기반 추론]` 같은 보라색 배지를 추가하여 문서에 명시되지 않았지만 맥락상 추론한 내용임을 표시했습니다.

배지 클릭 시 PDF 뷰어의 해당 페이지로 자동 스크롤되도록 구현했는데, 이 부분이 생각보다 까다로웠습니다. ReactMarkdown과 통합하고, DOM 렌더링 완료를 기다린 후 스크롤하는 로직을 추가해야 했습니다.

### 6. AI 지침 설정 시스템

사용자가 AI의 역할과 응답 스타일을 커스터마이징할 수 있는 기능을 추가했습니다. "서비스 운영자", "문서 분석가" 같은 프리셋을 제공하고, 사용자가 직접 지침을 입력할 수도 있습니다.

"적용" 버튼을 클릭하면 모든 AI 응답에 즉시 반영되며, 사용자 지침이 기본 프롬프트보다 우선 적용됩니다. UI 측면에서는 토글 버튼을 추가하여 필요할 때만 지침 입력 영역을 열 수 있도록 했습니다.

### 7. 다국어 지원

한국어와 영어를 지원하는 다국어 시스템을 구현했습니다. Context API를 사용하여 언어 상태를 관리하고, 사용자 입력 언어를 자동 감지하여 같은 언어로 응답하도록 했습니다.

### 8. 다중 AI 모델 지원

3개의 AI 모델을 지원하도록 구현했습니다:
- **GPT-4o-mini**: 빠른 응답, 문서 요약, 추천 질문 생성
- **GPT-4o**: 심층 분석, 복잡한 문서 해석
- **Gemini 3 Flash**: Google AI 기반 고품질 분석

모델 전환 시에도 대화 맥락이 유지되도록 구현했습니다.

### 9. 자동 문서 분석 및 추천 질문

파일을 업로드하면 자동으로 3-5줄 요약과 추천 질문 3개를 생성합니다. 이를 통해 사용자가 문서의 내용을 빠르게 파악하고 어떤 질문을 할 수 있는지 알 수 있게 했습니다.

### 10. 배포

Vercel을 통해 배포했습니다. GitHub에 코드를 푸시하고 Vercel 대시보드에서 저장소를 연결하면 자동으로 배포됩니다. 환경 변수는 Vercel 대시보드에서 설정했습니다.

## 개발 중 겪은 어려움과 해결 방법

### 1. PDF 텍스트 추출 문제

일부 PDF에서 텍스트 추출이 제대로 되지 않는 문제가 있었습니다. PDF.js의 다양한 옵션을 시도했고, 현재는 텍스트 기반 PDF에 집중하기로 했습니다.

### 2. 인용 배지와 ReactMarkdown 통합

ReactMarkdown 내에서 인용 패턴을 감지하고 배지로 변환하는 것이 까다로웠습니다. ReactMarkdown의 컴포넌트 오버라이드 기능을 활용하여 커스텀 렌더러를 구현했습니다.

### 3. PDF 뷰어 스크롤 연동

인용 배지 클릭 시 PDF 뷰어의 해당 페이지로 부드럽게 이동하는 것이 어려웠습니다. `useEffect`와 `scrollIntoView`를 조합하여 smooth scroll을 구현했고, DOM 렌더링 완료를 기다리기 위해 `setTimeout`을 활용했습니다.

### 4. 대화 기록 관리

처음에는 localStorage에 자동 저장/복원 기능을 구현했지만, 깨끗한 초기 화면을 위해 세션 기반으로 변경했습니다. 새로고침 시 대화가 초기화되도록 했습니다.

## 주요 기능 요약

완성된 주요 기능들은 다음과 같습니다:

1. **엄격한 파일 기반 대화 시스템**: 선택된 파일에만 기반한 답변, 할루시네이션 방지, 명확한 출처 표시

2. **NotebookLM 스타일 인용 시스템**: 클릭 가능한 페이지 배지, 범위 인용 지원, 자연어 패턴 자동 감지, 보라색 추론 배지

3. **PDF 처리**: PDF.js 통합, 페이지별 렌더링, 고품질 이미지 변환, 인용 연결

4. **AI 지침 설정**: 사용자 정의 AI 지침, 프리셋 제공, 실시간 적용

5. **다국어 지원**: 한국어/영어 UI, 언어 자동 감지

6. **다중 AI 모델 지원**: GPT-4o, GPT-4o-mini, Gemini 3 Flash

7. **자동 문서 분석**: 자동 요약, 추천 질문 생성

## 느낀 점

이 프로젝트를 통해 RAG 시스템의 중요성을 깊이 이해하게 되었습니다. 단순히 AI에게 질문하는 것이 아니라, **정확한 문서 기반의 답변**을 제공하는 것이 얼마나 중요한지 알게 되었습니다.

특히 **인용 배지 시스템**을 구현하면서, 사용자가 AI의 답변에 대해 신뢰할 수 있도록 **명확한 출처를 제공**하는 것이 핵심이라는 것을 깨달았습니다.

NotebookLM을 벤치마크로 하면서도, 우리만의 특색 있는 기능들(AI 지침 설정, 다중 모델 지원 등)을 추가하여 더 나은 사용자 경험을 제공할 수 있었습니다.

## 앞으로의 계획

현재는 기본 기능들을 완성했지만, 더 개선할 부분들이 있습니다:

- 다크모드 구현
- 모바일 반응형 디자인
- 대화 기록 저장/불러오기
- PDF 페이지 검색 기능
- Word/Excel 파일 지원

## 마무리

이번 포스트에서는 NotebookLM 스타일의 문서 분석 도구를 개발한 전체 과정을 공유했습니다. RAG 시스템 구축부터 인용 배지 시스템, AI 지침 설정까지, 하나씩 기능을 추가해 나가며 완성해 나간 여정을 정리했습니다.

프로젝트는 현재 Vercel에 배포되어 있으며, https://notebooklm-dashboard.vercel.app 에서 확인할 수 있습니다.

혹시 궁금한 점이나 함께 논의하고 싶은 부분이 있으시면 댓글로 남겨주세요! 감사합니다.
