# NotebookLM 스타일 문서 기반 분석 도구 + 웹 검색

엄격한 RAG(Retrieval-Augmented Generation) 시스템과 **실시간 웹 검색 기능**을 적용한 NotebookLM 스타일의 문서 분석 및 대화형 대시보드입니다.

## 🎯 핵심 기능

### 🌐 **NEW! 웹 검색 및 Deep Research 기능**
- **Fast Research (빠른 검색)**: 검색어 입력 → GPT가 추천 URL 생성 → 자동 크롤링 → 소스 추가
- **Deep Research (심층 분석)**: 여러 웹 페이지 종합 → GPT-4o로 1,000자 이상 리서치 리포트 자동 생성
- **실시간 진행률 표시**: "인터넷에서 최신 정보를 찾는 중..." 프로그레스 바
- **자동 소스 추가**: 웹에서 수집한 정보가 🌐 지구본 아이콘과 함께 소스 리스트에 자동 추가
- **리포트 타입**: Deep Research 결과는 📊 리포트 아이콘으로 구분 표시
- **모델 선택**: Instant (빠른 응답) / Thinking (심층 분석) 토글 선택 가능

### 1. 엄격한 파일 기반 대화 시스템
- **선택된 파일에만 기반한 답변**: 업로드한 문서의 내용에서만 답변을 생성
- **할루시네이션 방지**: 문서에 없는 내용은 절대 답변하지 않음
- **명확한 출처 표시**: 모든 답변에 참조 문서와 매칭된 키워드 표시
- **자동 문서 분석**: 파일 선택 시 자동으로 3-5줄 요약 생성
- **추천 질문 생성**: 문서 내용 기반 클릭 가능한 질문 3개 자동 생성

### 2. NotebookLM 스타일 자동 분석
- **즉시 요약**: 파일 선택 즉시 AI가 문서를 분석하고 요약 제공
- **추천 질문 버튼**: 문서 내용 기반 질문을 버튼으로 제공, 클릭 시 자동 전송
- **분석 진행 상태**: "문서를 분석하고 있습니다..." 로딩 메시지
- **일상 대화 지원**: 문서 없이도 간단한 인사 및 대화 가능

### 3. 다국어 지원 (한국어/English)
- UI 전체 다국어 지원 (한/영 토글)
- 사용자 입력 언어 자동 감지
- 감지된 언어로 자동 응답

### 4. 실시간 파일 처리 (PDF 강화)
- **지원 파일 형식**: PDF (실제 텍스트 추출), TXT, JSON
- **PDF.js 통합**: PDF 파일의 실제 텍스트를 클라이언트에서 추출
- 업로드된 파일을 구조화된 JSON으로 자동 파싱
- 실시간 데이터 프리뷰 (라이트 테마 JSON 뷰어)
- **복사 기능**: 클립보드에 JSON 데이터 복사
- **상세 디버깅 로그**: PDF 추출 전 과정 console.log로 추적 가능

### 5. NotebookLM 스타일 소스 관리
- **체크박스 기반 다중 선택**: 여러 소스 동시 선택 가능
- **소스 추가 모달**: 파일 업로드 또는 웹 URL 추가
- **Deep Research 배너**: NotebookLM 스타일 연구 기능 안내
- **전체 선택/해제**: 모든 소스 일괄 관리
- 선택된 소스 시각적 강조 표시
- 채팅 컨텍스트가 선택된 소스로 즉시 고정
- 소스 삭제 기능

## UI 레이아웃 (NotebookLM 스타일 3단 구조: 25% | 50% | 25%)

### 📁 소스 패널 (좌측 25%)

- **NotebookLM 스타일 "+ 소스 추가" 버튼** (캡슐 디자인)
- **Deep Research 배너**: 그라데이션 배경 (보라→파랑→초록)
- **웹 검색 바**: 실시간 웹 검색 및 크롤링 기능
  - Fast/Deep Research 토글
  - 검색 진행률 프로그레스 바
- **체크박스 기반 소스 선택 시스템**
  - 모두 선택/선택 해제 기능
  - 소스 타입별 아이콘 (📄 파일, 🌐 웹, 📊 리포트)
  - 원본 링크 버튼 (ExternalLink 아이콘)
- **컴팩트 디자인**: 좁은 패널에 최적화된 텍스트 크기 (text-xs, text-[10px])

### 💬 채팅 인터페이스 (중앙 50%)

- **모델 선택 토글**: ⚡ 빠름 (GPT-4o-mini) / 🧠 심층 (GPT-4o)
- **선택된 소스 표시**: 파란색 태그 (최대 2개 표시 + 나머지 개수)
- **메신저 스타일 대화형 UI**
  - **Universal Document Analyzer**: 맥락 기반 자율 분석 (No "No" Policy)
  - **ReactMarkdown 렌더링**: 굵은 글씨 (font-weight: 700), 헤더, 리스트 지원
  - **맥락 기반 추론 태그**: 💡 Lightbulb 아이콘과 함께 추론 답변 표시
  - **구조화된 답변**: 핵심 요약 → 상세 분석 (직접 근거 + 맥락 기반 분석) → AI 인사이트 → 출처/참조
- **자동 문서 분석**: 파일 선택 시 즉시 요약 + 추천 질문 생성
- **추천 질문 버튼**: 클릭 시 자동 전송
- **출처 및 키워드 매칭** 표시
- **일상 대화 모드**: 문서 없이도 간단한 대화 가능
- Enter/Shift+Enter 키보드 단축키

### 📊 스튜디오 패널 (우측 25%)

- **NotebookLM "Studio" 디자인**
- **복사 버튼**: JSON 데이터 원클릭 복사 (복사됨! 피드백)
- **파일 정보 카드**:
  - 파일명, 타입 (📄 File / 🌐 Web / 📊 Report), 상태 (준비완료)
- **구조화된 데이터 뷰어**
  - JSON 트리 구조 렌더링 (라이트 테마)
  - 확장/축소 가능한 JSON 구조
  - 타입별 색상 구분
    - 문자열: 녹색 (text-green-700)
    - 숫자: 파란색 (text-blue-600)
    - 키: 빨간색 (text-red-600)
    - Boolean/null: 보라색 (text-purple-600)
    - 배열 인덱스: 주황색 (text-orange-600)
  - 긴 문자열 축약 및 "더보기" 기능
- **업데이트 시간 표시**: 푸터에 마지막 업데이트 시간

## 기술 스택

- **React 18** - UI 프레임워크
- **Vite** - 빌드 도구 및 개발 서버
- **Tailwind CSS** - 유틸리티 기반 스타일링
- **Lucide React** - 아이콘 라이브러리
- **Context API** - 다국어 상태 관리
- **PDF.js (pdfjs-dist)** - PDF 텍스트 추출
- **react-markdown** + **remark-gfm** - Markdown 렌더링 및 GitHub Flavored Markdown 지원
- **OpenAI API**:
  - **GPT-4o-mini** - 빠른 응답, 문서 요약, 추천 질문 생성, 웹 검색
  - **GPT-4o** - Universal Document Analyzer, 심층 RAG 분석, Deep Research 리포트 생성
- **Web Crawling** - AllOrigins API (CORS 우회 프록시)로 웹 페이지 실시간 크롤링

## 설치 및 실행

### 1. 의존성 설치
```bash
npm install
```

### 2. 개발 서버 실행
```bash
npm run dev
```

### 3. 프로덕션 빌드
```bash
npm run build
```

### 4. 프리뷰
```bash
npm run preview
```

## 프로젝트 구조

```
notebooklm-dashboard/
├── src/
│   ├── components/
│   │   ├── SourcePanel.jsx      # NotebookLM 스타일 소스 관리 + 웹 검색 UI
│   │   ├── DataPreview.jsx      # JSON 뷰어 (복사 기능 포함)
│   │   └── ChatInterface.jsx    # 채팅 인터페이스 + 모델 선택
│   ├── contexts/
│   │   └── LanguageContext.jsx  # 다국어 지원 Context
│   ├── locales/
│   │   └── translations.js      # 한국어/영어 번역
│   ├── services/
│   │   ├── aiService.js         # 엄격한 RAG 로직 + 모델 관리
│   │   └── webSearchService.js  # 🌐 웹 검색 및 크롤링 엔진
│   ├── utils/
│   │   └── fileParser.js        # 파일 파싱 유틸리티
│   ├── App.jsx                  # 메인 앱 컴포넌트
│   ├── main.jsx                 # 엔트리 포인트
│   └── index.css                # 글로벌 스타일
├── public/
├── index.html
├── package.json
├── vite.config.js
├── tailwind.config.js
└── postcss.config.js
```

## 주요 컴포넌트

### SourcePanel

- "+ 소스 추가" 모달 시스템
- 체크박스 기반 다중 선택
- 파일 업로드 (PDF, Word, Excel, TXT, JSON)
- 전체 선택/선택 해제 버튼
- 파일 파싱 및 상태 관리

### DataPreview

- **클립보드 복사 기능**: JSON 데이터 원클릭 복사
- 복사 피드백: 2초간 "복사됨!" 표시
- JSON 트리 구조 렌더링 (라이트 테마)
- 확장/축소 토글 기능
- 타입별 색상 구분
- 긴 문자열 자동 축약 (100자 이상)
- 강화된 스타일: border-2, shadow-md

### ChatInterface

- **자동 문서 분석**: 파일 선택 시 즉시 요약 및 추천 질문 생성
- **추천 질문 UI**: 클릭 가능한 질문 버튼 (자동 제출)
- 다중 소스 컨텍스트 관리
- 선택된 소스 태그 표시
- 엄격한 RAG 기반 응답
- 출처 및 키워드 매칭 표시
- 문서 없음 경고 시스템
- 타이핑 인디케이터
- 자동 스크롤
- 다국어 메시지 지원
- **일상 대화 모드**: 문서 없이도 간단한 대화 가능

### LanguageContext

- 한국어/영어 전환
- 번역 함수 제공 (t())
- 전역 언어 상태 관리

## 핵심 기능 구현

### 엄격한 RAG 시스템 (aiService.js)

- **문서 자동 요약** (`generateDocumentSummary`): 파일 선택 시 3-5줄 요약 자동 생성
- **추천 질문 생성** (`generateSuggestedQuestions`): 문서 내용 기반 질문 3개 자동 생성
- **하이브리드 대화 모드** (`generateStrictRAGResponse`):
  - 일상 대화: 문서 없이도 인사/감사 등 간단한 대화 가능 (temperature: 0.8)
  - 문서 기반 답변: 엄격한 RAG로 문서 내용만 사용 (temperature: 0.3)
- **할루시네이션 방지**: 문서에 없는 내용은 "찾을 수 없습니다" 응답
- **언어 자동 감지**: 한글 정규식으로 입력 언어 감지
- **출처 표시**: 모든 답변에 파일명 표시 (📄 출처: filename)

### PDF 파일 파싱 (fileParser.js)

- **PDF.js 통합**: `extractPDFText` 함수로 실제 PDF 텍스트 추출
  - 로컬 워커 사용: CDN 대신 `pdfjs-dist/build/pdf.worker.min.mjs`
  - 페이지별 텍스트 추출: `getTextContent()` API 사용
  - 상세 디버깅 로그: 추출 과정 전체를 console.log로 추적
- **텍스트 추출** (`extractTextFromParsedData`): JSON 구조에서 RAG용 텍스트 추출
  - PDF: `extractedText` 필드 사용
  - TXT: 전체 내용 읽기
  - JSON: 파싱 및 구조화
  - 웹 URL: 메타데이터 추출 (시뮬레이션)
- 파일 크기 포맷팅 유틸리티

### 상태 관리

- 소스 목록 및 선택 상태 (sources, selectedSourceIds)
- 채팅 메시지 히스토리
- JSON 뷰어 확장/축소 상태
- 복사 버튼 피드백 상태
- 다국어 설정

## 최근 업데이트

### 🎨 2025-01-XX: NotebookLM UI 완전 재구성 + Universal Document Analyzer

- [x] **3단 레이아웃 (25% | 50% | 25%)**: NotebookLM과 동일한 구조로 완전 재설계
  - 좌측: 소스 패널 (컴팩트 디자인)
  - 중앙: 채팅 인터페이스 (50% 확대)
  - 우측: 스튜디오 패널 (JSON 뷰어)
- [x] **Universal Document Analyzer 시스템**: 맥락 기반 자율 분석
  - **No "No" Policy**: "정보가 없습니다" 절대 금지, 맥락 분석으로 추론
  - **가상 목차 자동 생성**: 목차 없는 문서도 페이지 헤더 분석으로 구조 파악
  - **논리적 추론 시스템**: 문서 전체 맥락(톤, 제목, 표, 반복 키워드)을 종합하여 답변 도출
  - **추론 투명성**: `[문서 맥락 기반 추론]` 태그로 추론 부분 명시
- [x] **ReactMarkdown 통합**: Markdown 렌더링 및 시각적 강조
  - **Bold 강제 렌더링**: `font-weight: 700` CSS 적용
  - **구조화된 답변 템플릿**: 헤더(###), 리스트, 굵은 글씨 자동 적용
  - **시각적 위계**: 핵심 명사, 수치, 기능명 굵게 표시
- [x] **컴팩트 UI 디자인**: 모든 컴포넌트 NotebookLM 스타일로 축소
  - 텍스트 크기: text-xs (12px), text-[10px], text-[9px]
  - 아이콘 크기: w-3 h-3 (12px), w-3.5 h-3.5 (14px)
  - 여백: p-2.5, space-y-2.5, px-2.5 py-0.5
- [x] **Lightbulb 추론 태그**: 맥락 기반 추론 답변에 💡 아이콘 표시

### ✅ 2025-12-26: 실시간 웹 검색 + GPT-4o 강제 기능

#### 🌐 실시간 웹 검색 시스템 (NEW!)
- [x] **검색 쿼리 최적화**: 사용자 질문을 실시간 검색어로 자동 변환
  - GPT-4o-mini가 날짜 + "실시간", "최신" 키워드 추가
  - 예: "삼성전자 주가 어때?" → "2025년 12월 26일 삼성전자 실시간 주가"
- [x] **10개 소스 크롤링**: GPT가 신뢰할 수 있는 URL 10개 추천 → 병렬 크롤링
- [x] **CORS 우회**: AllOrigins API 프록시로 클라이언트 측 웹 크롤링
- [x] **Fast/Deep Research**: 빠른 검색 (10개) / 심층 리포트 (5개 + GPT-4o 종합 분석)

#### 🔒 GPT-4o 과거 지식 차단 시스템 (NEW!)
- [x] **실시간 데이터 강제 사용**: 시스템 프롬프트에 "⚠️ 과거 학습 데이터 사용 금지" 명시
- [x] **날짜 컨텍스트**: 모든 답변에 현재 날짜 표시 및 수집 시간 명시
- [x] **출처 엄격화**: "📄 출처: ${fileName} (${today} 수집)" 형식 강제
- [x] **검증 로직**: "제공된 웹 검색 결과에 따르면" 등 실시간 데이터 인용 강제

#### ⚡ 듀얼 AI 모델 시스템
- [x] **모델 선택 UI**: Instant (⚡ GPT-4o-mini) / Thinking (🧠 GPT-4o) 토글
- [x] **작업별 최적화**:
  - Instant: 문서 요약, 추천 질문 생성, 일상 대화 (빠른 응답)
  - Thinking: 엄격한 RAG 분석, Deep Research 리포트 (심층 추론)
- [x] **사용자 선택 가능**: 채팅 헤더에서 실시간 모델 전환

#### 📚 다중 소스 RAG 지원
- [x] **여러 문서 동시 선택**: 체크박스로 다중 소스 선택
- [x] **통합 분석**: 선택된 모든 문서를 "[출처: name]" 구분자로 결합
- [x] **출처 추적**: 각 답변에 어느 문서에서 가져왔는지 명시

#### 🎨 UI/UX 개선
- [x] **Tooltip 컴포넌트**: 4방향 위치 지원 (top/bottom/left/right)
- [x] **원본 링크 버튼**: 웹 소스의 원본 사이트 바로가기 (ExternalLink 아이콘)
- [x] **검색 진행률**: "GPT가 추천 URL 생성 중...", "10개 웹페이지 크롤링 중..." 실시간 피드백
- [x] **소스 타입 아이콘**: 📄 파일, 🌐 웹, 📊 리포트 구분

#### 기존 기능
- [x] **PDF 실제 파싱**: PDF.js 통합으로 실제 텍스트 추출
- [x] **자동 문서 요약**: 파일 선택 시 AI가 자동으로 3-5줄 요약 생성
- [x] **추천 질문 생성**: 문서 내용 기반 클릭 가능한 질문 3개 자동 생성
- [x] **일상 대화 모드**: 문서 없이도 간단한 인사/대화 가능
- [x] **JSON 뷰어**: 복사 기능, 타입별 색상 구분, 확장/축소
- [x] **소스 삭제 기능**: 업로드된 파일 삭제 가능

### 🔧 알려진 제한사항
- [ ] **크롤링 성공률**: 일부 사이트는 크롤링 방지 정책으로 접근 제한
  - 해결 방안: Tavily/Serper API 통합 고려 중
- [ ] **PDF OCR 미지원**: 이미지 기반 PDF는 텍스트 추출 불가
  - 텍스트가 포함된 PDF만 지원

## 향후 개선 사항

- [ ] Word/Excel 파일 파싱 라이브러리 연동
  - mammoth.js (Word), xlsx (Excel)
- [ ] 웹 검색 기능 구현
  - Deep Research 기능 활성화
- [ ] 다중 소스 동시 참조 분석
  - 현재는 첫 번째 선택 소스만 사용
- [ ] 문서 내 검색 및 하이라이팅
- [ ] 대화 내역 저장/불러오기 (로컬 스토리지)
- [ ] 반응형 디자인 (모바일 지원)
- [ ] JSON 뷰어 다크모드 토글
- [ ] Claude API 통합 옵션 추가

## 라이선스

MIT
